<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />

  <title>Bartender Wingman</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel=“shortcut icon” href=“favicon.ico” type=“image/x-icon”>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous" />

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

  <style>
    #map {
      height: 25vh;
      width: 100%;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

  </style>

  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDu4DzSFnpfHDj2o7pQjKb2ZAnjxuloFHE&libraries=places"></script>

</head>


<script>
  var map;
  var service;
  var infowindow;

  function initialize() {

    var pyrmont = new google.maps.LatLng(-33.8665433, 151.1956316);

    map = new google.maps.Map(document.getElementById('map'), {
      center: pyrmont,
      zoom: 15
    })

    var input = document.getElementById('searchTextField');

    let autocomplete = new google.maps.places.Autocomplete(input)

    autocomplete.bindTo('bounds', map)

    let marker = new google.maps.Marker({
      map: map
    })

    google.maps.event.addListener(autocomplete, 'place_changed', () => {
      let place = autocomplete.getPlace()
      // console.log(place)
      // console.log(place.photos[0].getUrl())

      if (place.geometry.viewport) {
        map.fitBounds(place.geometry.viewport)
      } else {
        map.setCenter(place.geometry.location)
        map.setZoom(17)
      }
      marker.setPosition(place.geometry.location)
      marker.setVisible(true)

      let request = {
        location: place.geometry.location,
        radius: '50000',
        type: ['liquor_store']
      }

      service = new google.maps.places.PlacesService(map)
      service.nearbySearch(request, callback)

    })

  }

  function callback(results, status) {
    if (status == google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        var place = results[i];
        createMarker(results[i]);
      }
    }
  }


  function createMarker(place) {
    var marker = new google.maps.Marker({
      map: map,
      position: place.geometry.location
    });

    google.maps.event.addListener(marker, 'click', function () {
      alert(place.name);
      // window.open(place.photos[0].getUrl(), "_blank");
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize)
</script>



<body>

  <input id="searchTextField" type="text" size="50">
  <div id="map"></div>

  <noscript>You need to enable JavaScript to run this app.</noscript>

  <!-- The div to hold the map -->
  <!-- <div id="map"></div> -->
  <div id="root"></div>
  <!-- <script src="APP.JS"></script> -->
  <!-- <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDu4DzSFnpfHDj2o7pQjKb2ZAnjxuloFHE&libraries=places&callback=initMap&solution_channel=GMP_codelabs_simplestorelocator_v1_a">
    </script> -->
  <script>
    //   let map, service, infoWindow;
    //   function initMap() {
    //     const uluru = { lat: -25.344, lng: 131.031 };
    //     map = new google.maps.Map(document.getElementById('map'), {
    //       center: uluru,
    //       zoom: 8
    //     });
    //     infoWindow = new google.maps.InfoWindow();

    //     const marker = new google.maps.Marker({
    //       position: uluru,
    //       map: map,
    //     });

    //     const locationButton = document.createElement("button");

    //     locationButton.textContent = "Pan to Current Location";
    //     locationButton.classList.add("custom-map-control-button");
    //     map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);

    //     //////UNCOMMENT THIS CODE AS THIS WILL REDIRECT ME TO MY LOCATION UPON LOAD
    //     // if (navigator.geolocation) {
    //     //   navigator.geolocation.getCurrentPosition(
    //     //     (position) => {
    //     //       const pos = {
    //     //         lat: position.coords.latitude,
    //     //         lng: position.coords.longitude,
    //     //       };

    //     //       // infoWindow.setPosition(pos);
    //     //       // infoWindow.setContent("Location found.");
    //     //       // infoWindow.open({
    //     //       //   // anchor: marker,
    //     //       //   map
    //     //       // });
    //     //       const marker = new google.maps.Marker({
    //     //         position: pos,
    //     //         map: map,
    //     //       });
    //     //       map.setCenter(pos);
    //     //     },
    //     //     () => {
    //     //       handleLocationError(true, infoWindow, map.getCenter());
    //     //     }
    //     //   );
    //     // } else {
    //     //   // Browser doesn't support Geolocation
    //     //   handleLocationError(false, infoWindow, map.getCenter());
    //     // }


    //     locationButton.addEventListener("click", () => {
    //       // Try HTML5 geolocation.
    //       if (navigator.geolocation) {
    //         navigator.geolocation.getCurrentPosition(
    //           (position) => {
    //             const pos = {
    //               lat: position.coords.latitude,
    //               lng: position.coords.longitude,
    //             };

    //             infoWindow.setPosition(pos);
    //             infoWindow.setContent("Location found.");
    //             infoWindow.open({
    //               // anchor: marker,
    //               map
    //             });
    //             map.setCenter(pos);
    //           },
    //           () => {
    //             handleLocationError(true, infoWindow, map.getCenter());
    //           }
    //         );
    //       } else {
    //         // Browser doesn't support Geolocation
    //         handleLocationError(false, infoWindow, map.getCenter());
    //       }
    //     });

    //     var request = {
    //       query: 'Museum of Contemporary Art Australia',
    //       fields: ['name', 'geometry'],
    //     };

    //     var request2 = {
    //       location: uluru,
    //       radius: '50000',
    //       type: ['restaurant']
    //     };

    //     var request3 = {
    //       location: uluru,
    //       radius: '50000',
    //       query: 'restaurant'
    //     };

    //     var request4 = {
    //       placeId: 'ChIJN1t_tDeuEmsRUsoyG83frY4',
    //       fields: ['name', 'rating', 'formatted_phone_number', 'geometry']
    //     };

    //     var service = new google.maps.places.PlacesService(map);

    //     service.nearbySearch(request2, callback);

    //     service.textSearch(request3, callback2);

    //     service.getDetails(request4, callback3);

    //     service.findPlaceFromQuery(request, function (results, status) {
    //       if (status === google.maps.places.PlacesServiceStatus.OK) {
    //         for (var i = 0; i < results.length; i++) {
    //           createMarker(results[i]);
    //         }
    //         map.setCenter(results[0].geometry.location);
    //       }
    //     });
    //   }

    //   function createMarker(place) {
    //     if (!place.geometry || !place.geometry.location) return;

    //     const marker = new google.maps.Marker({
    //       map,
    //       position: place.geometry.location,
    //     });

    //     google.maps.event.addListener(marker, "click", () => {
    //       infoWindow.setContent(place.name || "");
    //       infoWindow.open(map);
    //     });
    //   }

    //   function createMarker2(place) {
    //     if (!place.geometry || !place.geometry.location) return;

    //     const marker = new google.maps.Marker({
    //       map,
    //       position: place.geometry.location,
    //     });

    //     google.maps.event.addListener(marker, "click", () => {
    //       const content = document.createElement("div");
    //       const nameElement = document.createElement("h2");

    //       nameElement.textContent = place.name;
    //       content.appendChild(nameElement);

    //       const placeIdElement = document.createElement("p");

    //       placeIdElement.textContent = place.place_id;
    //       content.appendChild(placeIdElement);

    //       const placeAddressElement = document.createElement("p");

    //       placeAddressElement.textContent = place.formatted_address;
    //       content.appendChild(placeAddressElement);
    //       infoWindow.setContent(content);
    //       infoWindow.open(map, marker);
    //     });
    //   }

    //   function callback(results, status) {
    //     if (status == google.maps.places.PlacesServiceStatus.OK) {
    //       for (var i = 0; i < results.length; i++) {
    //         createMarker(results[i]);
    //       }
    //     }
    //   }

    //   function callback2(results, status) {
    //     if (status == google.maps.places.PlacesServiceStatus.OK) {
    //       for (var i = 0; i < results.length; i++) {
    //         var place = results[i];
    //         createMarker(results[i]);
    //       }
    //     }
    //   }

    //   function callback3(place, status) {
    //     if (status == google.maps.places.PlacesServiceStatus.OK) {
    //       createMarker2(place);
    //     }
    //   }

    //   function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    //     infoWindow.setPosition(pos);
    //     infoWindow.setContent(
    //       browserHasGeolocation
    //         ? "Error: The Geolocation service failed."
    //         : "Error: Your browser doesn't support geolocation."
    //     );
    //     infoWindow.open(map);
    //   }

    //   window.initMap = initMap;


  // </script>

  <!-- <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDu4DzSFnpfHDj2o7pQjKb2ZAnjxuloFHE&libraries=places&callback=initMap">
    </script> -->

</body>

</html>
